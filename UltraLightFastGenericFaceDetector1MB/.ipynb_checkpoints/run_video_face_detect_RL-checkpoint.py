{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "priors nums:9984\n",
      "Inference time:  0.632905\n",
      "Time: 0.689826s, Detect Objects: 2.\n",
      "Inference time:  0.658328\n",
      "Time: 0.668382s, Detect Objects: 2.\n",
      "Inference time:  0.299115\n",
      "Time: 0.311404s, Detect Objects: 2.\n",
      "Inference time:  0.299458\n",
      "Time: 0.309374s, Detect Objects: 2.\n",
      "Inference time:  0.273769\n",
      "Time: 0.284575s, Detect Objects: 2.\n",
      "Inference time:  0.281627\n",
      "Time: 0.291498s, Detect Objects: 2.\n",
      "Inference time:  0.296209\n",
      "Time: 0.309635s, Detect Objects: 2.\n",
      "Inference time:  0.356488\n",
      "Time: 0.366212s, Detect Objects: 2.\n",
      "Inference time:  0.329645\n",
      "Time: 0.347142s, Detect Objects: 2.\n",
      "Inference time:  0.318141\n",
      "Time: 0.328103s, Detect Objects: 2.\n",
      "Inference time:  0.324562\n",
      "Time: 0.336257s, Detect Objects: 2.\n",
      "Inference time:  0.320329\n",
      "Time: 0.329710s, Detect Objects: 2.\n",
      "Inference time:  0.315401\n",
      "Time: 0.326206s, Detect Objects: 2.\n",
      "Inference time:  0.305723\n",
      "Time: 0.315740s, Detect Objects: 2.\n",
      "Inference time:  0.292539\n",
      "Time: 0.306353s, Detect Objects: 2.\n",
      "Inference time:  0.293584\n",
      "Time: 0.305333s, Detect Objects: 2.\n",
      "Inference time:  0.316322\n",
      "Time: 0.326272s, Detect Objects: 2.\n",
      "Inference time:  0.404936\n",
      "Time: 0.420957s, Detect Objects: 2.\n",
      "Inference time:  0.452681\n",
      "Time: 0.466170s, Detect Objects: 2.\n",
      "Inference time:  0.568797\n",
      "Time: 0.592129s, Detect Objects: 2.\n",
      "Inference time:  0.543046\n",
      "Time: 0.557999s, Detect Objects: 2.\n",
      "Inference time:  0.333387\n",
      "Time: 0.344611s, Detect Objects: 2.\n",
      "Inference time:  0.310603\n",
      "Time: 0.321793s, Detect Objects: 2.\n",
      "Inference time:  0.34377\n",
      "Time: 0.354990s, Detect Objects: 2.\n",
      "Inference time:  0.307347\n",
      "Time: 0.317291s, Detect Objects: 2.\n",
      "Inference time:  0.290281\n",
      "Time: 0.300135s, Detect Objects: 2.\n",
      "Inference time:  0.339167\n",
      "Time: 0.349497s, Detect Objects: 2.\n",
      "Inference time:  0.304303\n",
      "Time: 0.314856s, Detect Objects: 2.\n",
      "Inference time:  0.302238\n",
      "Time: 0.313095s, Detect Objects: 2.\n",
      "Inference time:  0.292862\n",
      "Time: 0.302912s, Detect Objects: 2.\n",
      "Inference time:  0.295882\n",
      "Time: 0.305761s, Detect Objects: 3.\n",
      "Inference time:  0.327947\n",
      "Time: 0.341102s, Detect Objects: 3.\n",
      "Inference time:  0.285153\n",
      "Time: 0.295403s, Detect Objects: 3.\n",
      "Inference time:  0.668446\n",
      "Time: 0.685519s, Detect Objects: 3.\n",
      "Inference time:  0.457127\n",
      "Time: 0.476263s, Detect Objects: 3.\n",
      "Inference time:  0.309434\n",
      "Time: 0.319739s, Detect Objects: 3.\n",
      "Inference time:  0.311922\n",
      "Time: 0.325206s, Detect Objects: 3.\n",
      "Inference time:  0.365652\n",
      "Time: 0.385661s, Detect Objects: 3.\n",
      "Inference time:  0.302403\n",
      "Time: 0.312569s, Detect Objects: 3.\n",
      "Inference time:  0.29203\n",
      "Time: 0.301615s, Detect Objects: 2.\n",
      "Inference time:  0.306859\n",
      "Time: 0.317492s, Detect Objects: 2.\n",
      "Inference time:  0.313767\n",
      "Time: 0.323152s, Detect Objects: 2.\n",
      "Inference time:  0.303276\n",
      "Time: 0.316468s, Detect Objects: 2.\n",
      "Inference time:  0.29885\n",
      "Time: 0.308696s, Detect Objects: 2.\n",
      "Inference time:  0.29315\n",
      "Time: 0.303277s, Detect Objects: 2.\n",
      "Inference time:  0.461995\n",
      "Time: 0.472223s, Detect Objects: 2.\n",
      "Inference time:  0.330423\n",
      "Time: 0.342265s, Detect Objects: 2.\n",
      "Inference time:  0.413386\n",
      "Time: 0.424854s, Detect Objects: 2.\n",
      "Inference time:  0.613111\n",
      "Time: 0.633670s, Detect Objects: 2.\n",
      "Inference time:  0.330053\n",
      "Time: 0.339208s, Detect Objects: 3.\n",
      "Inference time:  0.331005\n",
      "Time: 0.343298s, Detect Objects: 2.\n",
      "Inference time:  0.301117\n",
      "Time: 0.312218s, Detect Objects: 2.\n",
      "Inference time:  0.290424\n",
      "Time: 0.300644s, Detect Objects: 2.\n",
      "Inference time:  0.316374\n",
      "Time: 0.328837s, Detect Objects: 2.\n",
      "Inference time:  0.342245\n",
      "Time: 0.352686s, Detect Objects: 2.\n",
      "Inference time:  0.291146\n",
      "Time: 0.300903s, Detect Objects: 2.\n",
      "Inference time:  0.313754\n",
      "Time: 0.324506s, Detect Objects: 2.\n",
      "Inference time:  0.358303\n",
      "Time: 0.367250s, Detect Objects: 2.\n",
      "Inference time:  0.426556\n",
      "Time: 0.437185s, Detect Objects: 2.\n",
      "Inference time:  0.575963\n",
      "Time: 0.597727s, Detect Objects: 2.\n",
      "Inference time:  0.316562\n",
      "Time: 0.326666s, Detect Objects: 2.\n",
      "Inference time:  0.355142\n",
      "Time: 0.367954s, Detect Objects: 2.\n",
      "Inference time:  0.29519\n",
      "Time: 0.306257s, Detect Objects: 2.\n",
      "Inference time:  0.285519\n",
      "Time: 0.295424s, Detect Objects: 2.\n",
      "Inference time:  0.298879\n",
      "Time: 0.318149s, Detect Objects: 2.\n",
      "Inference time:  0.312012\n",
      "Time: 0.328215s, Detect Objects: 2.\n",
      "Inference time:  0.322433\n",
      "Time: 0.336438s, Detect Objects: 2.\n",
      "Inference time:  0.323402\n",
      "Time: 0.349683s, Detect Objects: 3.\n",
      "Inference time:  0.30571\n",
      "Time: 0.316334s, Detect Objects: 4.\n",
      "Inference time:  0.424205\n",
      "Time: 0.447080s, Detect Objects: 2.\n",
      "Inference time:  0.651673\n",
      "Time: 0.667542s, Detect Objects: 3.\n",
      "Inference time:  0.329591\n",
      "Time: 0.339033s, Detect Objects: 2.\n",
      "Inference time:  0.384154\n",
      "Time: 0.394472s, Detect Objects: 2.\n",
      "Inference time:  0.310682\n",
      "Time: 0.320558s, Detect Objects: 2.\n",
      "Inference time:  0.28652\n",
      "Time: 0.295426s, Detect Objects: 2.\n",
      "Inference time:  0.308531\n",
      "Time: 0.319002s, Detect Objects: 2.\n",
      "Inference time:  0.29316\n",
      "Time: 0.304397s, Detect Objects: 2.\n",
      "Inference time:  0.317533\n",
      "Time: 0.327288s, Detect Objects: 2.\n",
      "Inference time:  0.287195\n",
      "Time: 0.299648s, Detect Objects: 2.\n",
      "Inference time:  0.300821\n",
      "Time: 0.310290s, Detect Objects: 2.\n",
      "Inference time:  0.293317\n",
      "Time: 0.303804s, Detect Objects: 2.\n",
      "Inference time:  0.331214\n",
      "Time: 0.340634s, Detect Objects: 2.\n",
      "Inference time:  0.304783\n",
      "Time: 0.315394s, Detect Objects: 2.\n",
      "Inference time:  0.305092\n",
      "Time: 0.314892s, Detect Objects: 2.\n",
      "Inference time:  0.318646\n",
      "Time: 0.329130s, Detect Objects: 2.\n",
      "Inference time:  0.2899\n",
      "Time: 0.299132s, Detect Objects: 2.\n",
      "Inference time:  0.326165\n",
      "Time: 0.338296s, Detect Objects: 2.\n",
      "Inference time:  0.262496\n",
      "Time: 0.272620s, Detect Objects: 2.\n",
      "Inference time:  0.307689\n",
      "Time: 0.317890s, Detect Objects: 2.\n",
      "Inference time:  0.516566\n",
      "Time: 0.529622s, Detect Objects: 2.\n",
      "Inference time:  0.513618\n",
      "Time: 0.532035s, Detect Objects: 2.\n",
      "Inference time:  0.699647\n",
      "Time: 0.732407s, Detect Objects: 2.\n",
      "Inference time:  0.428382\n",
      "Time: 0.443436s, Detect Objects: 2.\n",
      "Inference time:  0.367137\n",
      "Time: 0.377009s, Detect Objects: 2.\n",
      "Inference time:  0.285274\n",
      "Time: 0.301262s, Detect Objects: 2.\n",
      "Inference time:  0.349054\n",
      "Time: 0.358110s, Detect Objects: 2.\n",
      "Inference time:  0.305225\n",
      "Time: 0.316038s, Detect Objects: 2.\n",
      "Inference time:  0.375162\n",
      "Time: 0.387485s, Detect Objects: 2.\n",
      "Inference time:  0.320834\n",
      "Time: 0.351584s, Detect Objects: 2.\n",
      "Inference time:  0.729694\n",
      "Time: 0.739710s, Detect Objects: 2.\n",
      "Inference time:  0.320336\n",
      "Time: 0.333013s, Detect Objects: 2.\n",
      "Inference time:  0.325037\n",
      "Time: 0.335828s, Detect Objects: 2.\n",
      "Inference time:  0.377361\n",
      "Time: 0.388197s, Detect Objects: 2.\n",
      "Inference time:  0.297012\n",
      "Time: 0.306482s, Detect Objects: 2.\n",
      "Inference time:  0.279946\n",
      "Time: 0.289996s, Detect Objects: 2.\n",
      "Inference time:  0.318942\n",
      "Time: 0.328660s, Detect Objects: 2.\n",
      "Inference time:  0.283201\n",
      "Time: 0.293345s, Detect Objects: 2.\n",
      "Inference time:  0.327315\n",
      "Time: 0.336991s, Detect Objects: 2.\n",
      "Inference time:  0.314328\n",
      "Time: 0.325919s, Detect Objects: 2.\n",
      "Inference time:  0.306914\n",
      "Time: 0.316143s, Detect Objects: 2.\n",
      "Inference time:  0.302927\n",
      "Time: 0.313146s, Detect Objects: 2.\n",
      "Inference time:  0.431403\n",
      "Time: 0.446822s, Detect Objects: 2.\n",
      "Inference time:  0.579527\n",
      "Time: 0.591642s, Detect Objects: 2.\n",
      "Inference time:  0.327362\n",
      "Time: 0.338433s, Detect Objects: 2.\n",
      "Inference time:  0.303962\n",
      "Time: 0.317614s, Detect Objects: 2.\n",
      "Inference time:  0.367842\n",
      "Time: 0.387389s, Detect Objects: 2.\n",
      "Inference time:  0.31437\n",
      "Time: 0.324764s, Detect Objects: 2.\n",
      "Inference time:  0.336456\n",
      "Time: 0.348052s, Detect Objects: 2.\n",
      "Inference time:  0.571515\n",
      "Time: 0.596745s, Detect Objects: 2.\n",
      "Inference time:  0.592147\n",
      "Time: 0.609423s, Detect Objects: 2.\n",
      "Inference time:  0.434438\n",
      "Time: 0.472628s, Detect Objects: 2.\n",
      "Inference time:  0.335986\n",
      "Time: 0.349578s, Detect Objects: 2.\n",
      "Inference time:  0.340466\n",
      "Time: 0.350795s, Detect Objects: 2.\n",
      "Inference time:  0.350152\n",
      "Time: 0.360258s, Detect Objects: 2.\n",
      "Inference time:  0.271817\n",
      "Time: 0.294494s, Detect Objects: 2.\n",
      "Inference time:  0.316616\n",
      "Time: 0.328635s, Detect Objects: 2.\n",
      "Inference time:  0.302046\n",
      "Time: 0.313606s, Detect Objects: 2.\n",
      "Inference time:  0.293827\n",
      "Time: 0.302698s, Detect Objects: 2.\n",
      "Inference time:  0.489364\n",
      "Time: 0.548163s, Detect Objects: 2.\n",
      "Inference time:  0.579413\n",
      "Time: 0.597796s, Detect Objects: 2.\n",
      "Inference time:  0.519165\n",
      "Time: 0.540899s, Detect Objects: 2.\n",
      "Inference time:  0.593712\n",
      "Time: 0.612274s, Detect Objects: 2.\n",
      "Inference time:  0.607262\n",
      "Time: 0.634412s, Detect Objects: 2.\n",
      "Inference time:  0.427931\n",
      "Time: 0.438737s, Detect Objects: 2.\n",
      "Inference time:  0.369465\n",
      "Time: 0.381331s, Detect Objects: 2.\n",
      "Inference time:  0.335658\n",
      "Time: 0.345230s, Detect Objects: 2.\n",
      "Inference time:  0.429798\n",
      "Time: 0.440702s, Detect Objects: 2.\n",
      "Inference time:  0.539984\n",
      "Time: 0.553034s, Detect Objects: 2.\n",
      "Inference time:  0.426678\n",
      "Time: 0.443244s, Detect Objects: 2.\n",
      "Inference time:  0.369917\n",
      "Time: 0.380268s, Detect Objects: 2.\n",
      "Inference time:  0.323127\n",
      "Time: 0.336435s, Detect Objects: 2.\n",
      "Inference time:  0.30651\n",
      "Time: 0.317003s, Detect Objects: 2.\n",
      "Inference time:  0.291044\n",
      "Time: 0.302466s, Detect Objects: 2.\n",
      "Inference time:  0.296744\n",
      "Time: 0.306378s, Detect Objects: 2.\n",
      "Inference time:  0.305452\n",
      "Time: 0.315557s, Detect Objects: 2.\n",
      "Inference time:  0.314051\n",
      "Time: 0.322382s, Detect Objects: 2.\n",
      "Inference time:  0.317092\n",
      "Time: 0.326934s, Detect Objects: 2.\n",
      "Inference time:  0.293852\n",
      "Time: 0.304074s, Detect Objects: 2.\n",
      "Inference time:  0.279423\n",
      "Time: 0.295343s, Detect Objects: 2.\n",
      "Inference time:  0.332136\n",
      "Time: 0.341257s, Detect Objects: 2.\n",
      "Inference time:  0.283499\n",
      "Time: 0.292651s, Detect Objects: 2.\n",
      "Inference time:  0.320966\n",
      "Time: 0.333968s, Detect Objects: 2.\n",
      "Inference time:  0.284155\n",
      "Time: 0.295374s, Detect Objects: 2.\n",
      "Inference time:  0.29356\n",
      "Time: 0.304619s, Detect Objects: 2.\n",
      "Inference time:  0.331793\n",
      "Time: 0.341822s, Detect Objects: 2.\n",
      "Inference time:  0.330119\n",
      "Time: 0.340657s, Detect Objects: 2.\n",
      "Inference time:  0.297301\n",
      "Time: 0.318691s, Detect Objects: 2.\n",
      "Inference time:  0.308465\n",
      "Time: 0.318077s, Detect Objects: 2.\n",
      "Inference time:  0.323006\n",
      "Time: 0.332621s, Detect Objects: 2.\n",
      "Inference time:  0.34182\n",
      "Time: 0.352196s, Detect Objects: 2.\n",
      "Inference time:  0.297278\n",
      "Time: 0.307988s, Detect Objects: 2.\n",
      "Inference time:  0.321132\n",
      "Time: 0.331041s, Detect Objects: 2.\n",
      "Inference time:  0.298044\n",
      "Time: 0.309541s, Detect Objects: 3.\n",
      "Inference time:  0.295444\n",
      "Time: 0.304126s, Detect Objects: 3.\n",
      "Inference time:  0.30588\n",
      "Time: 0.320471s, Detect Objects: 2.\n",
      "Inference time:  0.298051\n",
      "Time: 0.307753s, Detect Objects: 2.\n",
      "Inference time:  0.285566\n",
      "Time: 0.296023s, Detect Objects: 2.\n",
      "Inference time:  0.295949\n",
      "Time: 0.306901s, Detect Objects: 2.\n",
      "Inference time:  0.334764\n",
      "Time: 0.347395s, Detect Objects: 2.\n",
      "Inference time:  0.295391\n",
      "Time: 0.305039s, Detect Objects: 2.\n",
      "Inference time:  0.316649\n",
      "Time: 0.328152s, Detect Objects: 2.\n",
      "Inference time:  0.315696\n",
      "Time: 0.326302s, Detect Objects: 3.\n",
      "Inference time:  0.485774\n",
      "Time: 0.503755s, Detect Objects: 2.\n",
      "Inference time:  0.489693\n",
      "Time: 0.500511s, Detect Objects: 2.\n",
      "Inference time:  0.309592\n",
      "Time: 0.321698s, Detect Objects: 2.\n",
      "Inference time:  0.300289\n",
      "Time: 0.315538s, Detect Objects: 2.\n",
      "Inference time:  0.363627\n",
      "Time: 0.375802s, Detect Objects: 2.\n",
      "Inference time:  0.381437\n",
      "Time: 0.391613s, Detect Objects: 2.\n",
      "Inference time:  0.319202\n",
      "Time: 0.331633s, Detect Objects: 2.\n",
      "Inference time:  0.470086\n",
      "Time: 0.480707s, Detect Objects: 2.\n",
      "Inference time:  0.323838\n",
      "Time: 0.333582s, Detect Objects: 2.\n",
      "Inference time:  0.32777\n",
      "Time: 0.346565s, Detect Objects: 2.\n",
      "Inference time:  0.365525\n",
      "Time: 0.380935s, Detect Objects: 2.\n",
      "Inference time:  0.288065\n",
      "Time: 0.301051s, Detect Objects: 2.\n",
      "Inference time:  0.305048\n",
      "Time: 0.315629s, Detect Objects: 2.\n",
      "Inference time:  0.327353\n",
      "Time: 0.338548s, Detect Objects: 2.\n",
      "Inference time:  0.313136\n",
      "Time: 0.325478s, Detect Objects: 2.\n",
      "Inference time:  0.318602\n",
      "Time: 0.327591s, Detect Objects: 2.\n",
      "Inference time:  0.296428\n",
      "Time: 0.308637s, Detect Objects: 2.\n",
      "Inference time:  0.31321\n",
      "Time: 0.324555s, Detect Objects: 2.\n",
      "Inference time:  0.323542\n",
      "Time: 0.334174s, Detect Objects: 2.\n",
      "Inference time:  0.411464\n",
      "Time: 0.422457s, Detect Objects: 2.\n",
      "Inference time:  0.455057\n",
      "Time: 0.468901s, Detect Objects: 2.\n",
      "Inference time:  0.339684\n",
      "Time: 0.351348s, Detect Objects: 2.\n",
      "Inference time:  0.276514\n",
      "Time: 0.285467s, Detect Objects: 2.\n",
      "Inference time:  0.373117\n",
      "Time: 0.384457s, Detect Objects: 2.\n",
      "Inference time:  0.375774\n",
      "Time: 0.385538s, Detect Objects: 2.\n",
      "Inference time:  0.330381\n",
      "Time: 0.340678s, Detect Objects: 2.\n",
      "Inference time:  0.322347\n",
      "Time: 0.340359s, Detect Objects: 2.\n",
      "Inference time:  0.325171\n",
      "Time: 0.336021s, Detect Objects: 2.\n",
      "Inference time:  0.339841\n",
      "Time: 0.351348s, Detect Objects: 2.\n",
      "Inference time:  0.30405\n",
      "Time: 0.314766s, Detect Objects: 2.\n",
      "Inference time:  0.303552\n",
      "Time: 0.313375s, Detect Objects: 2.\n",
      "Inference time:  0.27783\n",
      "Time: 0.287642s, Detect Objects: 2.\n",
      "Inference time:  0.363965\n",
      "Time: 0.380943s, Detect Objects: 2.\n",
      "Inference time:  0.294529\n",
      "Time: 0.313477s, Detect Objects: 2.\n",
      "Inference time:  0.320516\n",
      "Time: 0.329781s, Detect Objects: 2.\n",
      "Inference time:  0.370212\n",
      "Time: 0.380960s, Detect Objects: 2.\n",
      "Inference time:  0.372485\n",
      "Time: 0.382968s, Detect Objects: 2.\n",
      "Inference time:  0.318199\n",
      "Time: 0.326634s, Detect Objects: 2.\n",
      "Inference time:  0.332683\n",
      "Time: 0.342269s, Detect Objects: 2.\n",
      "Inference time:  0.339177\n",
      "Time: 0.350018s, Detect Objects: 2.\n",
      "Inference time:  0.307952\n",
      "Time: 0.317482s, Detect Objects: 2.\n",
      "Inference time:  0.290392\n",
      "Time: 0.299721s, Detect Objects: 2.\n",
      "Inference time:  0.301906\n",
      "Time: 0.312186s, Detect Objects: 2.\n",
      "Inference time:  0.322434\n",
      "Time: 0.341369s, Detect Objects: 2.\n",
      "Inference time:  0.282197\n",
      "Time: 0.292976s, Detect Objects: 2.\n",
      "Inference time:  0.334971\n",
      "Time: 0.343423s, Detect Objects: 2.\n",
      "Inference time:  0.277798\n",
      "Time: 0.285214s, Detect Objects: 2.\n",
      "Inference time:  0.309658\n",
      "Time: 0.320217s, Detect Objects: 2.\n",
      "Inference time:  0.285974\n",
      "Time: 0.298052s, Detect Objects: 2.\n",
      "Inference time:  0.30834\n",
      "Time: 0.318638s, Detect Objects: 2.\n",
      "Inference time:  0.294529\n",
      "Time: 0.305166s, Detect Objects: 2.\n",
      "Inference time:  0.317847\n",
      "Time: 0.327847s, Detect Objects: 2.\n",
      "Inference time:  0.296611\n",
      "Time: 0.308548s, Detect Objects: 2.\n",
      "Inference time:  0.285707\n",
      "Time: 0.298661s, Detect Objects: 2.\n",
      "Inference time:  0.301421\n",
      "Time: 0.312357s, Detect Objects: 2.\n",
      "Inference time:  0.283128\n",
      "Time: 0.293462s, Detect Objects: 2.\n",
      "Inference time:  0.347\n",
      "Time: 0.357052s, Detect Objects: 2.\n",
      "Inference time:  0.243559\n",
      "Time: 0.258113s, Detect Objects: 2.\n",
      "Inference time:  0.286514\n",
      "Time: 0.297937s, Detect Objects: 2.\n",
      "Inference time:  0.319081\n",
      "Time: 0.330179s, Detect Objects: 2.\n",
      "Inference time:  0.288076\n",
      "Time: 0.298412s, Detect Objects: 2.\n",
      "Inference time:  0.32358\n",
      "Time: 0.334229s, Detect Objects: 2.\n",
      "Inference time:  0.292429\n",
      "Time: 0.300439s, Detect Objects: 2.\n",
      "Inference time:  0.339618\n",
      "Time: 0.350155s, Detect Objects: 2.\n",
      "Inference time:  0.277833\n",
      "Time: 0.289861s, Detect Objects: 2.\n",
      "Inference time:  0.336008\n",
      "Time: 0.346297s, Detect Objects: 2.\n",
      "Inference time:  0.310597\n",
      "Time: 0.322876s, Detect Objects: 2.\n",
      "Inference time:  0.314177\n",
      "Time: 0.324896s, Detect Objects: 2.\n",
      "Inference time:  0.329855\n",
      "Time: 0.338937s, Detect Objects: 2.\n",
      "Inference time:  0.33096\n",
      "Time: 0.344211s, Detect Objects: 2.\n",
      "Inference time:  0.356523\n",
      "Time: 0.366958s, Detect Objects: 2.\n",
      "Inference time:  0.292083\n",
      "Time: 0.303375s, Detect Objects: 2.\n",
      "Inference time:  0.334772\n",
      "Time: 0.352214s, Detect Objects: 2.\n",
      "Inference time:  0.372146\n",
      "Time: 0.381919s, Detect Objects: 2.\n",
      "Inference time:  0.358561\n",
      "Time: 0.369042s, Detect Objects: 2.\n",
      "Inference time:  0.30098\n",
      "Time: 0.311234s, Detect Objects: 2.\n",
      "Inference time:  0.331707\n",
      "Time: 0.344336s, Detect Objects: 2.\n",
      "Inference time:  0.580501\n",
      "Time: 0.602750s, Detect Objects: 2.\n",
      "Inference time:  0.59731\n",
      "Time: 0.616927s, Detect Objects: 2.\n",
      "Inference time:  0.479031\n",
      "Time: 0.501136s, Detect Objects: 2.\n",
      "Inference time:  0.297521\n",
      "Time: 0.308350s, Detect Objects: 2.\n",
      "Inference time:  0.338836\n",
      "Time: 0.349416s, Detect Objects: 2.\n",
      "Inference time:  0.425211\n",
      "Time: 0.435449s, Detect Objects: 2.\n",
      "Inference time:  0.302977\n",
      "Time: 0.314107s, Detect Objects: 2.\n",
      "Inference time:  0.323911\n",
      "Time: 0.334447s, Detect Objects: 2.\n",
      "Inference time:  0.354643\n",
      "Time: 0.364362s, Detect Objects: 2.\n",
      "Inference time:  0.391387\n",
      "Time: 0.402046s, Detect Objects: 2.\n",
      "Inference time:  0.353697\n",
      "Time: 0.363913s, Detect Objects: 2.\n",
      "Inference time:  0.337982\n",
      "Time: 0.351540s, Detect Objects: 2.\n",
      "Inference time:  0.317741\n",
      "Time: 0.331096s, Detect Objects: 2.\n",
      "Inference time:  0.330428\n",
      "Time: 0.343259s, Detect Objects: 2.\n",
      "Inference time:  0.361558\n",
      "Time: 0.371801s, Detect Objects: 2.\n",
      "Inference time:  0.362223\n",
      "Time: 0.373402s, Detect Objects: 2.\n",
      "Inference time:  0.363258\n",
      "Time: 0.374212s, Detect Objects: 2.\n",
      "Inference time:  0.339286\n",
      "Time: 0.347951s, Detect Objects: 2.\n",
      "Inference time:  0.423336\n",
      "Time: 0.433240s, Detect Objects: 2.\n",
      "Inference time:  0.295018\n",
      "Time: 0.305438s, Detect Objects: 2.\n",
      "Inference time:  0.404049\n",
      "Time: 0.414093s, Detect Objects: 2.\n",
      "Inference time:  0.35036\n",
      "Time: 0.360443s, Detect Objects: 2.\n",
      "Inference time:  0.358701\n",
      "Time: 0.370624s, Detect Objects: 2.\n",
      "Inference time:  0.295893\n",
      "Time: 0.306479s, Detect Objects: 2.\n",
      "Inference time:  0.357006\n",
      "Time: 0.367924s, Detect Objects: 2.\n",
      "Inference time:  0.417989\n",
      "Time: 0.433156s, Detect Objects: 2.\n",
      "Inference time:  0.438706\n",
      "Time: 0.449985s, Detect Objects: 2.\n",
      "Inference time:  0.350358\n",
      "Time: 0.361522s, Detect Objects: 2.\n",
      "Inference time:  0.293415\n",
      "Time: 0.306866s, Detect Objects: 2.\n",
      "Inference time:  0.3468\n",
      "Time: 0.357628s, Detect Objects: 2.\n",
      "Inference time:  0.334167\n",
      "Time: 0.345226s, Detect Objects: 2.\n",
      "Inference time:  0.312807\n",
      "Time: 0.322894s, Detect Objects: 2.\n",
      "Inference time:  0.309155\n",
      "Time: 0.319869s, Detect Objects: 2.\n",
      "Inference time:  0.321953\n",
      "Time: 0.331737s, Detect Objects: 2.\n",
      "Inference time:  0.277304\n",
      "Time: 0.287640s, Detect Objects: 2.\n",
      "Inference time:  0.352755\n",
      "Time: 0.371081s, Detect Objects: 2.\n",
      "Inference time:  0.31825\n",
      "Time: 0.332420s, Detect Objects: 2.\n",
      "Inference time:  0.374733\n",
      "Time: 0.385364s, Detect Objects: 2.\n",
      "Inference time:  0.296295\n",
      "Time: 0.305688s, Detect Objects: 2.\n",
      "Inference time:  0.362746\n",
      "Time: 0.373865s, Detect Objects: 2.\n",
      "Inference time:  0.542887\n",
      "Time: 0.566614s, Detect Objects: 2.\n",
      "Inference time:  0.509052\n",
      "Time: 0.523045s, Detect Objects: 2.\n",
      "Inference time:  0.395264\n",
      "Time: 0.418704s, Detect Objects: 2.\n",
      "Inference time:  0.287616\n",
      "Time: 0.297152s, Detect Objects: 2.\n",
      "Inference time:  0.474674\n",
      "Time: 0.484593s, Detect Objects: 2.\n",
      "Inference time:  0.410519\n",
      "Time: 0.420764s, Detect Objects: 2.\n",
      "Inference time:  0.55626\n",
      "Time: 0.583611s, Detect Objects: 2.\n",
      "Inference time:  0.48286\n",
      "Time: 0.500149s, Detect Objects: 2.\n",
      "Inference time:  0.645036\n",
      "Time: 0.656788s, Detect Objects: 2.\n",
      "Inference time:  0.338457\n",
      "Time: 0.348613s, Detect Objects: 2.\n",
      "Inference time:  0.333641\n",
      "Time: 0.354087s, Detect Objects: 2.\n",
      "Inference time:  0.424409\n",
      "Time: 0.434435s, Detect Objects: 2.\n",
      "Inference time:  0.587558\n",
      "Time: 0.606541s, Detect Objects: 2.\n",
      "Inference time:  0.779061\n",
      "Time: 0.810678s, Detect Objects: 2.\n",
      "Inference time:  0.58309\n",
      "Time: 0.598179s, Detect Objects: 2.\n",
      "Inference time:  0.457865\n",
      "Time: 0.472351s, Detect Objects: 2.\n",
      "Inference time:  0.427758\n",
      "Time: 0.438836s, Detect Objects: 2.\n",
      "Inference time:  0.525613\n",
      "Time: 0.547616s, Detect Objects: 2.\n",
      "Inference time:  0.544808\n",
      "Time: 0.565875s, Detect Objects: 2.\n",
      "Inference time:  0.588184\n",
      "Time: 0.603846s, Detect Objects: 2.\n",
      "Inference time:  0.60389\n",
      "Time: 0.624699s, Detect Objects: 2.\n",
      "Inference time:  0.748469\n",
      "Time: 0.772248s, Detect Objects: 2.\n",
      "Inference time:  0.511325\n",
      "Time: 0.530925s, Detect Objects: 2.\n",
      "Inference time:  0.350984\n",
      "Time: 0.366303s, Detect Objects: 2.\n",
      "Inference time:  0.349695\n",
      "Time: 0.364368s, Detect Objects: 2.\n",
      "Inference time:  0.360834\n",
      "Time: 0.374540s, Detect Objects: 2.\n",
      "Inference time:  0.328589\n",
      "Time: 0.339109s, Detect Objects: 2.\n",
      "Inference time:  0.35682\n",
      "Time: 0.382019s, Detect Objects: 2.\n",
      "Inference time:  0.764605\n",
      "Time: 0.785294s, Detect Objects: 2.\n",
      "Inference time:  0.567859\n",
      "Time: 0.586161s, Detect Objects: 2.\n",
      "Inference time:  0.342768\n",
      "Time: 0.355283s, Detect Objects: 2.\n",
      "Inference time:  0.418131\n",
      "Time: 0.436293s, Detect Objects: 2.\n",
      "Inference time:  0.407049\n",
      "Time: 0.433073s, Detect Objects: 2.\n",
      "Inference time:  0.377261\n",
      "Time: 0.388758s, Detect Objects: 2.\n",
      "Inference time:  0.342504\n",
      "Time: 0.354333s, Detect Objects: 2.\n",
      "Inference time:  0.341346\n",
      "Time: 0.352971s, Detect Objects: 2.\n",
      "Inference time:  0.342994\n",
      "Time: 0.352982s, Detect Objects: 2.\n",
      "Inference time:  0.312547\n",
      "Time: 0.324054s, Detect Objects: 2.\n",
      "Inference time:  0.477211\n",
      "Time: 0.485876s, Detect Objects: 2.\n",
      "Inference time:  0.489618\n",
      "Time: 0.513550s, Detect Objects: 2.\n",
      "Inference time:  0.509643\n",
      "Time: 0.531224s, Detect Objects: 2.\n",
      "Inference time:  0.302678\n",
      "Time: 0.330106s, Detect Objects: 2.\n",
      "Inference time:  0.340064\n",
      "Time: 0.351157s, Detect Objects: 2.\n",
      "Inference time:  0.323724\n",
      "Time: 0.333013s, Detect Objects: 2.\n",
      "Inference time:  0.287637\n",
      "Time: 0.315886s, Detect Objects: 2.\n",
      "Inference time:  0.312888\n",
      "Time: 0.331808s, Detect Objects: 2.\n",
      "Inference time:  0.320727\n",
      "Time: 0.330716s, Detect Objects: 2.\n",
      "Inference time:  0.316335\n",
      "Time: 0.327043s, Detect Objects: 2.\n",
      "Inference time:  0.29667\n",
      "Time: 0.311339s, Detect Objects: 2.\n",
      "Inference time:  0.291281\n",
      "Time: 0.301674s, Detect Objects: 2.\n",
      "Inference time:  0.290625\n",
      "Time: 0.299623s, Detect Objects: 2.\n",
      "Inference time:  0.269502\n",
      "Time: 0.279234s, Detect Objects: 2.\n",
      "Inference time:  0.337712\n",
      "Time: 0.349629s, Detect Objects: 2.\n",
      "Inference time:  0.282411\n",
      "Time: 0.288930s, Detect Objects: 2.\n",
      "Inference time:  0.314157\n",
      "Time: 0.325834s, Detect Objects: 2.\n",
      "Inference time:  0.299796\n",
      "Time: 0.315503s, Detect Objects: 2.\n",
      "Inference time:  0.30039\n",
      "Time: 0.311562s, Detect Objects: 2.\n",
      "Inference time:  0.299335\n",
      "Time: 0.309820s, Detect Objects: 2.\n",
      "Inference time:  0.325944\n",
      "Time: 0.336058s, Detect Objects: 2.\n",
      "Inference time:  0.302761\n",
      "Time: 0.315921s, Detect Objects: 2.\n",
      "Inference time:  0.32899\n",
      "Time: 0.338384s, Detect Objects: 2.\n",
      "Inference time:  0.308725\n",
      "Time: 0.323016s, Detect Objects: 2.\n",
      "Inference time:  0.368539\n",
      "Time: 0.377469s, Detect Objects: 2.\n",
      "Inference time:  0.309112\n",
      "Time: 0.319272s, Detect Objects: 2.\n",
      "Inference time:  0.300447\n",
      "Time: 0.310705s, Detect Objects: 2.\n",
      "Inference time:  0.349518\n",
      "Time: 0.359483s, Detect Objects: 2.\n",
      "Inference time:  0.280988\n",
      "Time: 0.291332s, Detect Objects: 2.\n",
      "Inference time:  0.373476\n",
      "Time: 0.388076s, Detect Objects: 2.\n",
      "Inference time:  0.434921\n",
      "Time: 0.452465s, Detect Objects: 2.\n",
      "Inference time:  0.324643\n",
      "Time: 0.333989s, Detect Objects: 2.\n",
      "Inference time:  0.402625\n",
      "Time: 0.413416s, Detect Objects: 2.\n",
      "Inference time:  0.418902\n",
      "Time: 0.429384s, Detect Objects: 2.\n",
      "Inference time:  0.418447\n",
      "Time: 0.429150s, Detect Objects: 2.\n",
      "Inference time:  0.355449\n",
      "Time: 0.369012s, Detect Objects: 2.\n",
      "Inference time:  0.446201\n",
      "Time: 0.463297s, Detect Objects: 2.\n",
      "Inference time:  0.515069\n",
      "Time: 0.534946s, Detect Objects: 2.\n",
      "Inference time:  0.361632\n",
      "Time: 0.371575s, Detect Objects: 2.\n",
      "Inference time:  0.317101\n",
      "Time: 0.328635s, Detect Objects: 2.\n",
      "Inference time:  0.435705\n",
      "Time: 0.449393s, Detect Objects: 2.\n",
      "Inference time:  0.485036\n",
      "Time: 0.496420s, Detect Objects: 2.\n",
      "Inference time:  0.418883\n",
      "Time: 0.438737s, Detect Objects: 2.\n",
      "Inference time:  0.3321\n",
      "Time: 0.343773s, Detect Objects: 2.\n",
      "Inference time:  0.335549\n",
      "Time: 0.379868s, Detect Objects: 2.\n",
      "Inference time:  0.298968\n",
      "Time: 0.309353s, Detect Objects: 2.\n",
      "Inference time:  0.27199\n",
      "Time: 0.280985s, Detect Objects: 2.\n",
      "Inference time:  0.469651\n",
      "Time: 0.481676s, Detect Objects: 2.\n",
      "Inference time:  0.360113\n",
      "Time: 0.403520s, Detect Objects: 2.\n",
      "Inference time:  0.305066\n",
      "Time: 0.314919s, Detect Objects: 2.\n",
      "Inference time:  0.353527\n",
      "Time: 0.366553s, Detect Objects: 2.\n",
      "Inference time:  0.283587\n",
      "Time: 0.293631s, Detect Objects: 2.\n",
      "Inference time:  0.339988\n",
      "Time: 0.351884s, Detect Objects: 2.\n",
      "end\n",
      "all face num:777\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "This code uses the pytorch model to detect faces from live video or camera.\n",
    "\"\"\"\n",
    "import argparse\n",
    "import sys\n",
    "import cv2\n",
    "\n",
    "from vision.ssd.config.fd_config import define_img_size\n",
    "\n",
    "parser = argparse.ArgumentParser(\n",
    "    description='detect_video')\n",
    "\n",
    "parser.add_argument('--net_type', default=\"RFB\", type=str,\n",
    "                    help='The network architecture ,optional: RFB (higher precision) or slim (faster)')\n",
    "parser.add_argument('--input_size', default=480, type=int,\n",
    "                    help='define network input size,default optional value 128/160/320/480/640/1280')\n",
    "parser.add_argument('--threshold', default=0.7, type=float,\n",
    "                    help='score threshold')\n",
    "parser.add_argument('--candidate_size', default=1000, type=int,\n",
    "                    help='nms candidate size')\n",
    "parser.add_argument('--path', default=\"imgs\", type=str,\n",
    "                    help='imgs dir')\n",
    "parser.add_argument('--test_device', default=\"cuda:0\", type=str,\n",
    "                    help='cuda:0 or cpu')\n",
    "parser.add_argument('--video_path', default=\"/home/linzai/Videos/video/16_1.MP4\", type=str,\n",
    "                    help='path of video')\n",
    "\n",
    "#args = parser.parse_args()\n",
    "args = parser.parse_args(\"\")## Modified by Rong Li for runing on Jupyter Notebook\n",
    "args.video_path = \"videos/1024290770-preview.mp4\" ## Modified by Rong Li\n",
    "\n",
    "input_img_size = args.input_size\n",
    "define_img_size(input_img_size)  # must put define_img_size() before 'import create_mb_tiny_fd, create_mb_tiny_fd_predictor'\n",
    "\n",
    "from vision.ssd.mb_tiny_fd import create_mb_tiny_fd, create_mb_tiny_fd_predictor\n",
    "from vision.ssd.mb_tiny_RFB_fd import create_Mb_Tiny_RFB_fd, create_Mb_Tiny_RFB_fd_predictor\n",
    "from vision.utils.misc import Timer\n",
    "\n",
    "label_path = \"./models/voc-model-labels.txt\"\n",
    "\n",
    "net_type = args.net_type\n",
    "\n",
    "cap = cv2.VideoCapture(args.video_path)  # capture from video\n",
    "# cap = cv2.VideoCapture(0)  # capture from camera\n",
    "\n",
    "class_names = [name.strip() for name in open(label_path).readlines()]\n",
    "num_classes = len(class_names)\n",
    "test_device = \"cpu\" # Rong Li: args.test_device\n",
    "\n",
    "candidate_size = args.candidate_size\n",
    "threshold = args.threshold\n",
    "\n",
    "if net_type == 'slim':\n",
    "    model_path = \"models/pretrained/version-slim-320.pth\"\n",
    "    # model_path = \"models/pretrained/version-slim-640.pth\"\n",
    "    net = create_mb_tiny_fd(len(class_names), is_test=True, device=test_device)\n",
    "    predictor = create_mb_tiny_fd_predictor(net, candidate_size=candidate_size, device=test_device)\n",
    "elif net_type == 'RFB':\n",
    "    model_path = \"models/pretrained/version-RFB-320.pth\"\n",
    "    # model_path = \"models/pretrained/version-RFB-640.pth\"\n",
    "    net = create_Mb_Tiny_RFB_fd(len(class_names), is_test=True, device=test_device)\n",
    "    predictor = create_Mb_Tiny_RFB_fd_predictor(net, candidate_size=candidate_size, device=test_device)\n",
    "else:\n",
    "    print(\"The net type is wrong!\")\n",
    "    sys.exit(1)\n",
    "net.load(model_path)\n",
    "\n",
    "timer = Timer()\n",
    "sum = 0\n",
    "while True:\n",
    "    ret, orig_image = cap.read()\n",
    "    if orig_image is None:\n",
    "        print(\"end\")\n",
    "        break\n",
    "    image = cv2.cvtColor(orig_image, cv2.COLOR_BGR2RGB)\n",
    "    timer.start()\n",
    "    boxes, labels, probs = predictor.predict(image, candidate_size / 2, threshold)\n",
    "    interval = timer.end()\n",
    "    print('Time: {:.6f}s, Detect Objects: {:d}.'.format(interval, labels.size(0)))\n",
    "    for i in range(boxes.size(0)):\n",
    "        box = boxes[i, :]\n",
    "        label = f\" {probs[i]:.2f}\"\n",
    "        cv2.rectangle(orig_image, (box[0], box[1]), (box[2], box[3]), (0, 255, 0), 4)\n",
    "\n",
    "        # cv2.putText(orig_image, label,\n",
    "        #             (box[0], box[1] - 10),\n",
    "        #             cv2.FONT_HERSHEY_SIMPLEX,\n",
    "        #             0.5,  # font scale\n",
    "        #             (0, 0, 255),\n",
    "        #             2)  # line type\n",
    "    orig_image = cv2.resize(orig_image, None, None, fx=0.8, fy=0.8)\n",
    "    sum += boxes.size(0)\n",
    "    cv2.imshow('annotated', orig_image)\n",
    "    if cv2.waitKey(1) & 0xFF == ord('q'):\n",
    "        break\n",
    "cap.release()\n",
    "cv2.destroyAllWindows()\n",
    "print(\"all face num:{}\".format(sum))\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
